<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>마이페이지</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        background-color: #f4f4f4;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background-color: #fff;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      .profile {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
      }
      .profile-info {
        display: flex;
        align-items: center;
      }
      .profile-image {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin-right: 20px;
        object-fit: cover;
      }
      .profile-details h1 {
        margin: 0 0 10px 0;
      }
      .stats {
        list-style-type: none;
        padding: 0;
      }
      .stats li {
        margin-bottom: 5px;
      }
      .buttons {
        display: flex;
        flex-direction: column;
      }
      .button {
        padding: 10px 20px;
        margin-bottom: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }
      .edit-button {
        background-color: #4caf50;
        color: white;
      }
      .delete-button {
        background-color: #f44336;
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="profile">
        <div class="profile-info">
          <img
            id="profile-image"
            src="./"
            alt="프로필 사진"
            class="profile-image"
          />
          <div class="profile-details">
            <h1 id="nickname"></h1>
            <ul class="stats">
              <li>게시글: <span id="posts-count"></span></li>
              <li>리뷰: <span id="reviews-count"></span></li>
              <li>좋아요: <span id="likes-count"></span></li>
            </ul>
          </div>
        </div>
        <div class="buttons">
          <button id="edit-button" class="button edit-button">
            회원정보 수정
          </button>
          <button id="delete-button" class="button delete-button">탈퇴</button>
        </div>
      </div>
    </div>

    <script>
      // 사용자 데이터를 가져오는 함수
      async function fetchUserData() {
        try {
          // 실제 API 엔드포인트로 교체해야 합니다
          const response = await fetch("https://api.example.com/user");
          const userData = await response.json();
          return userData;
        } catch (error) {
          console.error("Failed to fetch user data:", error);
          return null;
        }
      }

      // 페이지 요소 업데이트 함수
      function updatePage(userData) {
        document.getElementById("profile-image").src = userData.profileImage;
        document.getElementById("nickname").textContent = userData.nickname;
        document.getElementById("posts-count").textContent =
          userData.stats.posts;
        document.getElementById("reviews-count").textContent =
          userData.stats.reviews;
        document.getElementById("likes-count").textContent =
          userData.stats.likes;
      }

      // 회원정보 수정 함수
      function editProfile() {
        // 실제 구현에서는 수정 페이지로 이동하거나 모달을 열어 정보를 수정할 수 있게 합니다
        console.log("회원정보 수정");
        alert("회원정보 수정 페이지로 이동합니다.");
      }

      // 회원 탈퇴 함수
      async function deleteAccount() {
        if (confirm("정말로 탈퇴하시겠습니까?")) {
          try {
            // 실제 API 엔드포인트로 교체해야 합니다
            const response = await fetch("https://api.example.com/user", {
              method: "DELETE",
            });
            if (response.ok) {
              alert("탈퇴가 완료되었습니다.");
              // 로그아웃 처리 또는 메인 페이지로 리다이렉트
              window.location.href = "/";
            } else {
              throw new Error("탈퇴 처리 중 오류가 발생했습니다.");
            }
          } catch (error) {
            console.error("Failed to delete account:", error);
            alert("탈퇴 처리 중 오류가 발생했습니다. 다시 시도해 주세요.");
          }
        }
      }

      // 페이지 로드 시 실행
      window.addEventListener("load", async () => {
        const userData = await fetchUserData();
        if (userData) {
          updatePage(userData);
        } else {
          alert("사용자 데이터를 불러오는 데 실패했습니다.");
        }

        // 버튼에 이벤트 리스너 추가
        document
          .getElementById("edit-button")
          .addEventListener("click", editProfile);
        document
          .getElementById("delete-button")
          .addEventListener("click", deleteAccount);
      });
    </script>
  </body>
</html>
